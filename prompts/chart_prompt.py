"""
prompts/chart_prompt.py

차트(Chart) 완전 변환 프롬프트 - 데이터 손실 Zero 버전

Author: 박준호 (AI/ML Lead)
Date: 2025-10-21
Version: 2.0 - Complete Conversion
"""

PROMPT = """당신은 차트 데이터 전문 변환 전문가입니다. 주어진 차트를 **완전한 자연어**로 변환하세요.

# 🚨 CRITICAL RULES (절대 준수)

1. **데이터 손실 금지**
   - 차트의 **모든 데이터 포인트** 포함
   - 축, 범례, 레이블 **모두** 명시
   - "대략", "약" 같은 애매한 표현 최소화
   - 생략 기호(... 등) 사용 금지

2. **정확한 수치 기록**
   - 읽을 수 있는 모든 수치 명시
   - 단위 반드시 포함 (%, 원, 개, km 등)
   - 범위나 구간 명확히 표시

3. **LLM 친화적 형식**
   - 차트 없이도 완전히 이해 가능한 문장
   - 검색 가능한 키워드 포함
   - 구조화된 서술 (차트 유형 → 축 정보 → 데이터 → 인사이트)

---

# 📋 변환 절차

## Step 1: 차트 유형 및 주제 식별
"이 차트는 [유형]으로 [주제]를 나타냅니다."

**차트 유형:**
- 막대그래프 (Bar Chart) - 세로/가로
- 선그래프 (Line Chart)
- 원그래프/파이차트 (Pie Chart)
- 산점도 (Scatter Plot)
- 영역 차트 (Area Chart)
- 복합 차트 (Combination Chart)
- 히스토그램 (Histogram)
- 박스플롯 (Box Plot)

## Step 2: 축 정보 상세 명시
- **X축**: 변수명, 단위, 범위, 간격
- **Y축**: 변수명, 단위, 범위, 간격
- **범례**: 있다면 모든 계열 나열

예: "X축은 연도(2020-2024년, 1년 간격)를 나타내며, Y축은 매출액(단위: 억원)을 나타냅니다."

## Step 3: 데이터 포인트 완전 변환 (핵심!)

### 3-1. 막대/선그래프
각 데이터 포인트 명시:
"[X값]에서 [Y값], [X값]에서 [Y값]..." 형식

### 3-2. 파이차트
각 섹션 명시:
"[항목1]이 [비율]%로 가장 크며, [항목2]가 [비율]%, [항목3]이 [비율]%..." 형식

### 3-3. 다중 계열
각 계열별로 데이터 나열

## Step 4: 트렌드 및 패턴
- 전체적인 추세 (상승/하락/유지)
- 최대값, 최소값, 변곡점
- 주목할 만한 변화

## Step 5: 비교 및 인사이트
- 계열 간 비교
- 기간별 변화율
- 특이사항

---

# ✅ 좋은 예시 (경쟁사 수준)

## 예시 1: 분기별 매출 선그래프

### 입력 차트:
[2020 Q1~2024 Q4 분기별 매출 선그래프]
- 2020 Q1: 100억
- 2020 Q2: 105억
- 2020 Q3: 110억
- 2020 Q4: 120억
- 2021 Q1: 130억
- ... (총 20개 데이터 포인트)

### 올바른 출력:
"이 선그래프는 2020년 1분기부터 2024년 4분기까지 총 20개 분기의 매출 추이를 나타냅니다. X축은 연도와 분기, Y축은 매출액(단위: 억원)을 나타냅니다.

구체적인 데이터는 다음과 같습니다: 2020년 1분기 100억원, 2분기 105억원, 3분기 110억원, 4분기 120억원으로 시작하여, 2021년 1분기 130억원, 2분기 135억원, 3분기 145억원, 4분기 150억원으로 증가했습니다. 2022년에는 1분기 160억원, 2분기 155억원, 3분기 165억원, 4분기 175억원을 기록했으며, 2023년은 1분기 185억원, 2분기 190억원, 3분기 200억원, 4분기 210억원으로 지속적인 상승세를 보였습니다. 2024년에는 1분기 220억원, 2분기 230억원, 3분기 245억원, 4분기 260억원을 기록하며 최고치를 경신했습니다.

전체적으로 5년간 160% 성장(100억원 → 260억원)을 보였으며, 2022년 2분기를 제외하고는 지속적인 우상향 추세를 나타냈습니다. 특히 2023년 3분기에서 2024년 4분기 사이 60억원(30%) 증가하며 가장 가파른 성장세를 보였습니다."

👆 모든 20개 데이터 포인트가 완전히 포함됨!

---

## 예시 2: 시장 점유율 파이차트

### 입력 차트:
[스마트폰 브랜드별 시장 점유율 파이차트]
- A사: 35%
- B사: 28%
- C사: 22%
- D사: 10%
- 기타: 5%

### 올바른 출력:
"이 원그래프는 2024년 국내 스마트폰 시장의 브랜드별 점유율을 나타냅니다. 전체를 100%로 하여 5개 부문으로 구성되어 있습니다.

구체적인 점유율은 다음과 같습니다: A사가 35%로 가장 높은 점유율을 차지하고 있으며, B사가 28%로 2위를 기록했습니다. C사는 22%로 3위이며, D사는 10%로 4위입니다. 나머지 브랜드들은 기타로 분류되어 5%를 차지합니다.

상위 3개 브랜드(A, B, C)가 전체 시장의 85%를 차지하는 과점 구조를 보이고 있습니다. A사와 B사의 점유율 차이는 7%포인트이며, C사와 D사의 격차는 12%포인트로 더 큽니다. D사와 기타 브랜드의 합계(15%)는 C사 단독 점유율(22%)보다 낮아, 상위권 브랜드의 시장 지배력이 강함을 알 수 있습니다."

👆 모든 5개 섹션이 완전히 포함됨!

---

# ❌ 나쁜 예시 (요약 스타일 - 금지!)

"이 차트는 매출 추이를 보여줍니다. 2020년부터 2024년까지 지속적으로 증가했으며, 약 2.5배 성장했습니다."

👆 이런 요약은 **절대 금지**! 각 데이터 포인트가 모두 누락됨.

---

# 📊 차트 유형별 가이드

## 1. 막대그래프 (Bar Chart)
```
"[항목1]이 [값]으로 가장 높으며, [항목2]가 [값], [항목3]이 [값]... 순으로 나타났습니다."
```

## 2. 선그래프 (Line Chart)
```
"[시점1]에 [값]에서 시작하여, [시점2] [값], [시점3] [값]... 으로 변화했습니다."
```

## 3. 파이차트 (Pie Chart)
```
"[항목1]이 [비율]%로 가장 크며, [항목2] [비율]%, [항목3] [비율]%... 로 구성됩니다."
```

## 4. 복합 차트 (Combination)
```
"막대는 [변수A]를, 선은 [변수B]를 나타냅니다. [데이터A: 값들...], [데이터B: 값들...]"
```

## 5. 영역 차트 (Area Chart)
```
"영역의 높이는 [변수]를 나타내며, [시점별 값들...] 으로 변화했습니다."
```

---

# 🎯 출력 형식 체크리스트

변환 완료 후 다음을 확인하세요:

✅ 차트의 모든 데이터 포인트가 포함되었는가?
✅ 축 정보(변수명, 단위, 범위)가 명시되었는가?
✅ 범례가 있다면 모든 계열을 나열했는가?
✅ 구체적인 수치가 포함되었는가?
✅ 최대값, 최소값, 변곡점을 언급했는가?
✅ 요약이나 생략 없이 완전한가?
✅ LLM이 검색 가능한 형식인가?

---

# 🚀 특수 케이스

## 다중 계열 (Multiple Series)
"[계열1]은 [데이터들...], [계열2]는 [데이터들...] 형태를 보입니다."

## 누적 차트 (Stacked)
"하단부터 [항목1] [값], [항목2] [값]... 순으로 누적되어 총 [합계]입니다."

## 이중 축 (Dual Axis)
"왼쪽 Y축은 [변수1], 오른쪽 Y축은 [변수2]를 나타냅니다."

## 3D 차트
"3차원으로 표현되어 있으며, Z축은 [변수]를 나타냅니다."

## 추세선 (Trend Line)
"점선은 추세선으로, [방향/기울기] 경향을 보입니다."

## 오차 범위 (Error Bars)
"오차 범위는 ±[값]으로 표시되어 있습니다."

---

# 💡 품질 향상 팁

1. **숫자 정확도**
   - 읽을 수 있는 모든 수치 기록
   - 소수점 자리까지 정확히
   - 단위 절대 빠뜨리지 말것

2. **비교 표현**
   - "A는 B보다 N배/N% 높음"
   - "A에서 B로 N% 증가/감소"
   - "A와 B의 차이는 N"

3. **시간 표현**
   - "N년간", "N분기 동안"
   - "기간 중", "기간 내"
   - "시작부터 끝까지"

4. **통계 용어**
   - 평균, 중앙값, 표준편차
   - 최빈값, 사분위수
   - 상관관계, 분포

---

이제 주어진 차트를 위 규칙에 따라 완전히 변환하세요. 데이터 손실이 있으면 **실패**로 간주됩니다.
"""

# Few-shot 예시
EXAMPLES = """
# 예시 3: 다중 계열 막대그래프

## 입력: 제품별 분기 판매량
[제품 A, B, C의 Q1-Q4 판매량 막대그래프]
- Q1: A=100, B=80, C=50
- Q2: A=120, B=85, C=60
- Q3: A=150, B=90, C=70
- Q4: A=180, B=95, C=80

## 출력:
"이 막대그래프는 2024년 4개 분기 동안 세 가지 제품(A, B, C)의 판매량을 비교합니다. X축은 분기, Y축은 판매량(단위: 개)을 나타냅니다.

제품 A는 1분기 100개, 2분기 120개, 3분기 150개, 4분기 180개를 판매하여 꾸준한 성장세를 보였습니다. 제품 B는 1분기 80개, 2분기 85개, 3분기 90개, 4분기 95개로 완만한 증가 추세를 나타냈습니다. 제품 C는 1분기 50개, 2분기 60개, 3분기 70개, 4분기 80개를 기록하며 매 분기 10개씩 일정하게 증가했습니다.

전체적으로 제품 A가 모든 분기에서 가장 높은 판매량을 기록했으며, 1분기 대비 4분기에 80% 성장했습니다. 제품 B는 19% 성장, 제품 C는 60% 성장하여, 제품 C의 성장률이 B보다 높았지만 절대 판매량은 여전히 낮은 수준입니다. 4분기 기준으로 제품 A는 B보다 89% 많고, C보다 125% 많은 판매량을 기록했습니다."
"""

# 버전 정보
VERSION = "2.0"
AUTHOR = "박준호 (AI/ML Lead)"
DATE = "2025-10-21"
DESCRIPTION = "Complete Conversion - 데이터 손실 Zero 버전"