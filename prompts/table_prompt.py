"""
prompts/table_prompt.py

표(Table) 완전 변환 프롬프트 - 데이터 손실 Zero 버전

Author: 박준호 (AI/ML Lead)
Date: 2025-10-21
Version: 2.0 - Complete Conversion
"""

PROMPT = """당신은 표 데이터 전문 변환 전문가입니다. 주어진 표를 **완전한 자연어**로 변환하세요.

# 🚨 CRITICAL RULES (절대 준수)

1. **데이터 손실 금지**
   - 표의 **모든 행**을 반드시 변환
   - 표의 **모든 열**을 반드시 포함
   - "총 N개" 같은 요약 표현 금지
   - 생략 기호(... 등) 사용 금지

2. **행별 완전 서술**
   - 각 행마다 독립적인 문장으로 작성
   - 순서대로 "첫 번째 항목", "두 번째 항목" 형식
   - 모든 셀 값을 문장 안에 자연스럽게 포함

3. **LLM 친화적 형식**
   - 표 없이도 완전히 이해 가능한 문장
   - 검색 가능한 키워드 포함
   - 구조화된 서술 (헤더 설명 → 행별 상세)

---

# 📋 변환 절차

## Step 1: 표 구조 파악
먼저 표의 전체 구조를 분석:
- 헤더(열 제목) 모두 나열
- 총 행 수 확인
- 데이터 타입 파악

## Step 2: 헤더 설명 및 의미 명시 (중요!)
"이 표는 [주제]에 대한 정보를 담고 있습니다. 표의 열은 [열1, 열2, 열3, ...]으로 구성되어 있습니다."

**🚨 열 의미 정확히 파악 (혼동 방지):**
- **배차간격**: 버스가 오는 시간 간격 (예: 8분 = 8분마다 버스 옴)
  - ❌ "8분 소요" (잘못됨 - 이건 소요시간)
  - ✅ "배차간격 8분" 또는 "8분 간격"
- **쪽수/페이지**: 상세정보가 있는 페이지 번호
  - ❌ "노선번호 143" (잘못됨)
  - ✅ "143페이지" 또는 "쪽수 143"
- **소요시간**: 기점→종점 이동 시간 (표에 있을 경우)
- **첫차/막차**: 운행 시작/종료 시각

**표 작성자의 의도를 정확히 파악하여 열 의미 그대로 전달하세요.**

## Step 3: 행별 완전 변환 (핵심!)
**각 행마다 다음 형식으로 작성:**

```
[순서] 항목[은/으로/인] [열1값], [열2값], [열3값]...[이며/입니다]. 
[추가 열이 있다면 계속 나열]. [페이지 참조가 있다면] [N]페이지를 참조하십시오.

**⚠️ 주의: 열 의미를 정확히 표현**
- 배차간격 → "배차간격은 N분" (❌ "N분 소요")
- 페이지 → "N페이지" (❌ "노선번호 N")
```

**예시:**
- "첫 번째 항목인 신설 울주09 노선은 기점과 종점이 모두 중촌마을이며, 배차간격은 8분입니다. 기점 기준 첫차 시각은 06:10, 막차 시각은 22:00이며, 관련 내용은 143페이지에 있습니다."

## Step 4: 패턴 및 인사이트 (선택)
모든 행을 서술한 **이후에만** 전체 패턴 언급 가능

---

# ✅ 좋은 예시 (경쟁사 수준)

## 입력: 버스 노선표

| 구분 | 노선번호 | 기점 | 종점 | 배차간격 | 첫차 | 막차 | 페이지 |
|------|----------|------|------|----------|------|------|--------|
| 신설 | 울주09 | 중촌마을 | 중촌마을 | 8 | 06:10 | 22:00 | 143 |
| 신설 | 울주10 | 서생역 | 간절곶회센터 | 39 | 06:50 | 21:15 | 144 |
| 신설 | 울주11 | 망양역 | 개운포역 | 74 | 06:10 | 22:05 | 145 |

## 출력:

"이 표는 신설된 울주군 버스 노선에 대한 정보를 담고 있습니다. 표의 열은 구분, 노선번호, 기점, 종점, 배차간격, 첫차, 막차, 페이지로 구성되어 있습니다.

첫 번째 항목인 신설 울주09 노선은 기점과 종점이 모두 중촌마을이며, 배차간격은 8분입니다. 기점 기준 첫차 시각은 06:10, 막차 시각은 22:00이며, 관련 내용은 143페이지에 있습니다.

두 번째 항목인 신설 울주10 노선은 기점이 서생역, 종점이 간절곶회센터이며, 배차간격은 39분입니다. 기점 기준 첫차 시각은 06:50, 막차 시각은 21:15이며, 144페이지를 참조하십시오.

세 번째 항목인 신설 울주11 노선은 기점이 망양역, 종점이 개운포역이며, 배차간격은 74분입니다. 기점 기준 첫차 시각은 06:10, 막차 시각은 22:05이며, 145페이지에 해당 내용이 기재되어 있습니다."

---

# ❌ 나쁜 예시 (요약 스타일 - 금지!)

"이 표는 울주군 버스 노선 정보입니다. 총 3개 노선이 있으며, 배차간격은 8~74분 사이입니다. 운행시간은 새벽 6시부터 밤 10시까지입니다."

👆 이런 요약은 **절대 금지**! 각 행의 모든 데이터가 누락됨.

---

# 📊 복잡한 표 처리 가이드

## 1. 다단계 헤더 (Merged Header)
"표는 [주제]를 다루며, [대분류1] 아래에 [소분류1-1, 소분류1-2]가, [대분류2] 아래에 [소분류2-1, 소분류2-2]가 있습니다."

## 2. 많은 행 (20+ rows)
- 그룹이 있다면: "◆ [그룹명]" 섹션으로 분리
- 없다면: 계속 "N번째 항목..." 형식 유지
- 절대 "나머지는 비슷함" 같은 표현 금지

## 3. 계산된 값 (합계, 평균)
"...이며, 합계는 [N]입니다." 또는 "전체 평균은 [N]입니다." 추가

## 4. 각주/참조
"...이며, 자세한 내용은 [N]페이지를 참조하십시오." 또는 "[*] 표시는 [설명]을 의미합니다."

---

# 🎯 출력 형식 체크리스트

변환 완료 후 다음을 확인하세요:

✅ 표의 모든 행이 변환되었는가?
✅ 각 행의 모든 열 값이 포함되었는가?
✅ 순서대로 "첫 번째, 두 번째..." 형식인가?
✅ 페이지 참조가 있다면 명시했는가?
✅ 요약이나 생략 없이 완전한가?
✅ LLM이 검색 가능한 형식인가?

---

# 🚀 특수 케이스

## 빈 셀
"...이며, [열명]은 기재되어 있지 않습니다."

## 병합된 셀
"[열1]과 [열2]가 동일하게 [값]이며..."

## 색상/강조
"(볼드체로 강조)" 또는 "(붉은색으로 표시)"

## 체크박스/기호
"선택됨 ✓" 또는 "미선택 ○"

---

이제 주어진 표를 위 규칙에 따라 완전히 변환하세요. 데이터 손실이 있으면 **실패**로 간주됩니다.
"""

# Few-shot 예시 (더 명확하게)
EXAMPLES = """
# 예시 1: 직행좌석버스 노선표 (17개 항목)

## 입력 표:
[노선번호, 기점, 종점, 배차간격, 첫차, 막차, 페이지가 17행인 표]

## 올바른 출력:
"이 표는 직행좌석버스의 노선 번호, 운행정보, 시간표 정보를 제공합니다. 표의 열은 개편 전 노선 번호, 개편 후 노선 번호, 기점, 종점, 배차간격, 기점 기준 첫차 시각, 기점 기준 막차 시각, 그리고 해당 페이지 번호로 구성되어 있습니다.

첫 번째 항목으로 신설된 1114번 노선은 기점이 대왕암공원, 종점이 율리차고지이며, 배차간격은 22분입니다. 기점 기준 첫차 시각은 05:05, 막차 시각은 23:00이며, 148페이지를 참조하십시오.

두 번째 항목으로 신설된 1115번 노선은 기점이 꽃바위차고지, 종점이 덕하차고지이며, 배차간격은 24분입니다. 기점 기준 첫차 시각은 05:10, 막차 시각은 23:05이며, 149페이지를 참조하십시오.

세 번째 항목으로 신설된 1134번 노선은 기점이 꽃바위차고지, 종점이 율리차고지이며, 배차간격은 20분입니다. 기점 기준 첫차 시각은 05:10, 막차 시각은 23:20이며, 150페이지를 참조하십시오.

네 번째 항목은 개편 전 1137번, 개편 후 1144번 노선으로, 기점은 꽃바위차고지, 종점은 노포동이며, 배차간격은 95분입니다. 기점 기준 첫차 시각은 05:30, 막차 시각은 20:00이며, 151페이지를 참조하십시오.

다섯 번째 항목으로 신설된 1154번 노선은 기점이 명촌차고지, 종점이 노포동이며, 배차간격은 30분입니다. 기점 기준 첫차 시각은 04:50, 막차 시각은 22:30이며, 152페이지를 참조하십시오.

여섯 번째 항목은 개편 전 1127번, 개편 후 1214번 노선으로, 기점은 농소차고지, 종점은 노포동이며, 배차간격은 39분입니다. 기점 기준 첫차 시각은 04:30, 막차 시각은 20:50이며, 153페이지를 참조하십시오.

일곱 번째 항목은 개편 전 1147번, 개편 후 1224번 노선으로, 기점은 농소차고지, 종점은 노포동이며, 배차간격은 20분입니다. 기점 기준 첫차 시각은 04:40, 막차 시각은 22:15이며, 154페이지를 참조하십시오.

여덟 번째 항목은 개편 전 1401번, 개편 후 1411번 노선으로, 기점은 율리차고지, 종점은 대왕암공원이며, 배차간격은 22분입니다. 기점 기준 첫차 시각은 05:25, 막차 시각은 23:00이며, 155페이지를 참조하십시오.

아홉 번째 항목은 개편 전후 모두 1421번 노선으로, 기점은 율리차고지, 종점은 현대중공업이며, 배차간격은 21분입니다. 기점 기준 첫차 시각은 05:35, 막차 시각은 22:30이며, 156페이지를 참조하십시오.

열 번째 항목으로 신설된 1432번 노선은 기점이 율리차고지, 종점이 모화이며, 배차간격은 19분입니다. 기점 기준 첫차 시각은 05:30, 막차 시각은 22:40이며, 157페이지를 참조하십시오.

열한 번째 항목으로 신설된 1452번 노선은 기점이 율리차고지, 종점이 달천회관이며, 배차간격은 21분입니다. 기점 기준 첫차 시각은 05:20, 막차 시각은 21:00이며, 158페이지를 참조하십시오.

열두 번째 항목으로 신설된 1462번 노선은 기점이 율리차고지, 종점이 매곡이며, 배차간격은 21분입니다. 기점 기준 첫차 시각은 05:30, 막차 시각은 22:40이며, 159페이지를 참조하십시오.

열세 번째 항목은 개편 전후 모두 1703번 노선으로, 기점은 우성스마트시티뷰, 종점은 태화강역이며, 배차간격은 66분입니다. 기점 기준 첫차 시각은 05:40, 막차 시각은 22:10이며, 160페이지를 참조하십시오.

열네 번째 항목은 개편 전후 모두 1713번 노선으로, 기점은 석남사, 종점은 태화강역이며, 배차간격은 19분입니다. 기점 기준 첫차 시각은 05:00, 막차 시각은 22:00이며, 161페이지를 참조하십시오.

열다섯 번째 항목으로 신설된 1715번 노선은 기점이 명촌차고지, 종점이 진하공영주차장이며, 배차간격은 23분입니다. 기점 기준 첫차 시각은 05:20, 막차 시각은 22:40이며, 162페이지를 참조하십시오.

열여섯 번째 항목은 개편 전후 모두 1723번 노선으로, 기점은 신평(통도사), 종점은 태화강역이며, 배차간격은 35분입니다. 기점 기준 첫차 시각은 05:10, 막차 시각은 22:15이며, 163페이지를 참조하십시오.

열일곱 번째 항목은 개편 전후 모두 1733번 노선으로, 기점은 양우내안애, 종점은 태화강역이며, 배차간격은 39분입니다. 기점 기준 첫차 시각은 05:25, 막차 시각은 22:40이며, 164페이지를 참조하십시오."

👆 모든 17개 행이 완전히 포함됨!

---

# 예시 2: 리무진버스 노선표 (5개 항목)

"이 표는 리무진버스의 노선 번호, 운행정보, 시간표 정보를 제공합니다. 표의 열은 개편 전 노선 번호, 개편 후 노선 번호, 기점, 종점, 배차간격, 기점 기준 첫차 시각, 기점 기준 막차 시각, 그리고 해당 페이지 번호로 구성되어 있습니다.

첫 번째 항목은 개편 전후 모두 5001번 노선으로, 기점은 KTX울산역, 종점은 꽃바위차고지이며, 배차간격은 25분입니다. 기점 기준 첫차 시각은 05:20, 막차 시각은 24:00이며, 166페이지를 참조하십시오.

두 번째 항목은 개편 전후 모두 5002번 노선으로, 기점은 KTX울산역, 종점은 꽃바위차고지이며, 배차간격은 30분입니다. 기점 기준 첫차 시각은 05:30, 막차 시각은 24:00이며, 167페이지를 참조하십시오.

세 번째 항목은 개편 전후 모두 5003번 노선으로, 기점은 KTX울산역, 종점은 대안입구이며, 배차간격은 54분입니다. 기점 기준 첫차 시각은 06:00, 막차 시각은 24:00이며, 168페이지를 참조하십시오.

네 번째 항목은 개편 전후 모두 5004번 노선으로, 기점은 KTX울산역, 종점은 남창고이며, 배차간격은 37분입니다. 기점 기준 첫차 시각은 05:30, 막차 시각은 24:00이며, 169페이지를 참조하십시오.

다섯 번째 항목은 개편 전후 모두 5005번 노선으로, 기점은 KTX울산역, 종점은 달천이며, 배차간격은 48분입니다. 기점 기준 첫차 시각은 06:00, 막차 시각은 24:00이며, 170페이지를 참조하십시오."

👆 모든 5개 행이 완전히 포함됨!
"""

# 버전 정보
VERSION = "2.0"
AUTHOR = "박준호 (AI/ML Lead)"
DATE = "2025-10-21"
DESCRIPTION = "Complete Conversion - 데이터 손실 Zero 버전"