# PRISM Phase 2.7 - Python Dependencies
# Python 3.11+ 호환 (Python 3.12 완전 지원)
# 최종 수정: 2025-10-20 (3단계 설치 전략)

# ============================================
# 중요: 3단계 설치 방법
# ============================================
# 1단계: pip install --upgrade pip
# 2단계: pip install -r requirements.txt
# 3단계: pip install paddleocr==2.7.0 --no-deps
#
# 이유: PaddleOCR이 PyMuPDF<1.21.0을 요구하지만,
#       실제로는 pymupdf 1.24.14와도 정상 작동함.
#       의존성 체크만 우회하면 됩니다.

# ============================================
# Core Framework
# ============================================
streamlit==1.31.0
python-dotenv==1.0.0

# ============================================
# PDF Processing (Phase 2.7 핵심)
# ============================================
# PyMuPDF: Python 3.12 완전 호환 + 미리 빌드된 wheel
pymupdf==1.24.14        # Phase 2.7 메인: PDF → 이미지 변환 (빌드 도구 불필요)
pdf2image==1.16.3       # 레거시 호환: Poppler 기반
Pillow==10.2.0          # 이미지 처리

# ============================================
# PDF Processing (레거시 - 선택적 유지)
# ============================================
PyPDF2==3.0.1          # 레거시 코드에서 사용 중일 수 있음
pdfplumber==0.10.3     # 레거시 코드에서 사용 중일 수 있음

# ============================================
# OCR 기반 패키지 (PaddleOCR 의존성들만 먼저 설치)
# ============================================
paddlepaddle==2.6.0    # Python 3.12 호환
# paddleocr는 3단계에서 --no-deps로 별도 설치

# PaddleOCR 의존성들 (명시적 설치)
shapely>=1.7.1
scikit-image>=0.17.2
imgaug>=0.4.0
pyclipper>=1.2.1
lmdb>=1.2.1
tqdm>=4.62.0
visualdl>=2.2.3
rapidfuzz>=2.0.0
opencv-python<=4.6.0.66
opencv-contrib-python<=4.6.0.66
cython>=0.29.0
lxml>=4.6.0
premailer>=3.9.0
openpyxl>=3.0.0
attrdict>=2.0.1
python-docx>=0.8.11
beautifulsoup4>=4.9.3
fonttools>=4.24.0
fire>=0.3.0
pdf2docx>=0.5.0

# ============================================
# VLM APIs (Phase 2.7 Stage 1, 2)
# ============================================
anthropic==0.18.1      # Claude API (메인)
openai==1.12.0         # Azure OpenAI (선택)

# ============================================
# Utilities
# ============================================
numpy==1.26.3          # Python 3.12 호환
requests==2.31.0       # HTTP 요청
setuptools>=65.0.0     # PaddleOCR 내부 의존성 (Python 3.12 필수)

# ============================================
# 설치 가이드 (반드시 순서대로!)
# ============================================
#
# 1. pip 업그레이드:
#    pip install --upgrade pip
#
# 2. 메인 패키지 설치:
#    pip install -r requirements.txt
#
# 3. PaddleOCR 강제 설치 (의존성 체크 무시):
#    pip install paddleocr==2.7.0 --no-deps
#
# 4. 설치 확인:
#    python -c "import fitz; print(f'PyMuPDF: {fitz.__version__}')"
#    python -c "import paddleocr; print('PaddleOCR: OK')"
#    python -c "import anthropic; print('Anthropic: OK')"
#
# 5. poppler-utils 설치 (pdf2image용):
#    Windows: https://github.com/oschwartz10612/poppler-windows/releases
#             다운로드 후 환경변수 PATH에 poppler/bin 추가
#    Mac: brew install poppler
#    Linux: sudo apt-get install poppler-utils
#
# ============================================
# 주의사항
# ============================================
# - 3단계 설치가 핵심입니다!
# - --no-deps 플래그로 PaddleOCR의 의존성 체크를 우회합니다
# - 실제로는 pymupdf 1.24.14와 완벽하게 호환됩니다
# - Visual C++ 빌드 도구 불필요
# - Python 3.12 완전 호환